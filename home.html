<!DOCTYPE html>
<html>

<head>
  <title>Gimnasio Fitness</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <h2>Bienvenido, <span id="nombreUsuario"></span></h2>


  <a href="editar.html">Editar perfil</a><br><br>
  <button onclick="logout()">Cerrar sesión</button>

  <h3>Actividades disponibles</h3>
  <div id="clases"></div>

  <h3>Mis Reservas</h3>
  <ul id="misReservas"></ul>

  <script type="module" src="script.js"></script>
  <script>
    // Mostrar el nombre del usuario
    const nombreUsuario = localStorage.getItem('nombre');
    document.getElementById('nombreUsuario').textContent = nombreUsuario || 'Invitado';
    // Cargar las clases disponibles
    async function cargarClases() {
      const response = await fetch('http://localhost:3000/clases');
      const clases = await response.json();
      const clasesDiv = document.getElementById('clases');
      clasesDiv.innerHTML = ''; // Limpiar el contenido previo
      clases.forEach(clase => {
        const claseDiv = document.createElement('div');
        claseDiv.innerHTML = `
          <h4>${clase.nombre}</h4>
          <p>Fecha: ${new Date(clase.fecha).toLocaleDateString()}</p>
          <p>Hora: ${new Date(clase.fecha).toLocaleTimeString()}</p>
          <p>Instructor: ${clase.instructor}</p>
          <button onclick="reservarClase(${clase.id})">Reservar</button>
        `;
        clasesDiv.appendChild(claseDiv);
      });
    }
    // Reservar una clase
    async function reservarClase(claseId) {
      const response = await fetch(`http://localhost:3000/clases/${claseId}/reservar`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ usuarioId: localStorage.getItem('usuarioId') })
      });
      if (response.ok) {
        alert('Clase reservada con éxito');
        cargarClases();
        cargarMisReservas();
      } else {
        alert('Error al reservar la clase');
      }
    }
    // Cargar las reservas del usuario
    async function cargarMisReservas() {
      const usuarioId = localStorage.getItem('usuarioId');
      const response = await fetch(`http://localhost:3000/usuarios/${usuarioId}/reservas`);
      const reservas = await response.json();
      const misReservasUl = document.getElementById('misReservas');
      misReservasUl.innerHTML = ''; // Limpiar el contenido previo
      reservas.forEach(reserva => {
        const li = document.createElement('li');
        li.textContent = `${reserva.clase.nombre} - ${new Date(reserva.clase.fecha).toLocaleDateString()} ${new Date(reserva.clase.fecha).toLocaleTimeString()}`;
        misReservasUl.appendChild(li);
      });
    }
    // Cerrar sesión
    function logout() {
      localStorage.removeItem('usuarioId');
      localStorage.removeItem('nombre');
      window.location.href = 'index.html'; // Redirigir al login
    }
    // Cargar las clases y reservas al iniciar
    document.addEventListener('DOMContentLoaded', () => {
      cargarClases();
      cargarMisReservas();
    });   
  </script>
</body>

</html>
<!-- This is the home page where users can see available classes and their reservations. -->
<!-- It includes functionality to reserve classes and view personal reservations. -->
<!-- The user's name is displayed, and they can edit their profile or log out. -->
<!-- The script fetches class data from the server and allows users to interact with it. -->
<!-- The page is styled with an external CSS file. -->
<!-- The script is modular, allowing for easy maintenance and updates. -->
<!-- The page is responsive and user-friendly, providing a seamless experience for gym members. -->
<!-- The home page serves as the main hub for users to manage their gym activities. -->
<!-- The page is designed to be simple and intuitive, making it easy for users to navigate.
  